<!DOCTYPE html>
<html>
  <head>
    <!-- sample origin: https://github.com/googlearchive/webplatform-samples -->
    <!-- http://localhost/webspeechdemo/webspeechdemo.html -->
    <meta charset="utf-8">
    <title>WebDuplex plugin - demo 2</title>
    <link href="./assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="./assets/webduplex/css/webduplex.min.css" rel="stylesheet">
    <style>
      * {
        font-family: Verdana, Arial, sans-serif;
      }
      a:link {
        color:#000;
        text-decoration: none;
      }
      a:visited {
        color:#000;
      }
      a:hover {
        color:#33F;
      }
      .credits{
        width: inherit; 
        text-align: center; 
        margin-top: 10px; 
        position: fixed; 
        top: 0;
        overflow: auto;
        /*bottom: 0;*/
      }
      .action_credits{
        background: #ddd;
        position: fixed;
        /*right: 0;*/
        top: 0;
        width: 500px;
        height: 100%;
        padding: 10px;

        right: -500px;
        transition: all 0.55s ease-in-out;
      }
      .action_credits.showing{
        right: 0px;
        transition: all 0.55s ease-in-out;
      }
      .btnca{
        transform: rotate(270deg);
        /*position: relative;
        right: 69px;
        top: 11px;*/
        position: absolute;
        right: 477px;
        top: 21px;
        border-radius: 0;
      }
      .webduplexnote{
        position: fixed;
        bottom: 0;
        left: 0;
        padding-left: 5px;
        padding-bottom: 5px;
        margin: 0;
        background-color: #ffffff;
      }
    </style>
  </head>
  <body>
    <!-- nav -->
      <div class="navbar navbar-custom navbar-fixed-top" style="background: #ddd">
        <div class="navbar-header"><a class="navbar-brand" href="<?php echo base_url();?>">Webduplex store</a>
          <a class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="menu_block nav navbar-nav">
            <li><a href="<?php echo base_url();?>about-us">About us</a></li>
            <li><a href="<?php echo base_url();?>contact-us">Contact us</a></li>
            <li><a href="<?php echo base_url();?>how-it-works">How it works?</a></li>
            <li><a href="<?php echo base_url();?>privacy-policy">Privacy policy</a></li>
            <li><a href="<?php echo base_url();?>terms-of-use">Terms of use</a></li>
          </ul>
        </div>
      </div>
    <!-- nav ends -->

    <style type="text/css">
      .product_div {
        width: 80%;
        margin: 0 auto;
      }
      .proimg{
        width: 100%;
      }
      .product_img{
        background-image: url(../images/background.jpg);
        background-repeat: no-repeat;
        background-size: cover;
      }
    </style>
    <div class="col-md-12 p-0">
      <br/>
      <div class="product_div row">
        <div class="col-md-5 product_img">
          <!-- <img class="proimg" src="../images/background.jpg"> -->
        </div>
        <div class="col-md-7 product_content">
          <h3 class="m-0">Realme XT Smartphone</h3>
          <small>Mobile > Smart > Brand > Realme</small>
          <br/><br/>
          <h5>Features</h5>
          <p class="m-0">
            - 8 GB RAM | 128 GB ROM | Expandable Upto 256 GB<br/>
            - 16.26 cm (6.4 inch) Display<br/>
            - 64MP + 8MP + 2MP + 2MP Quad Camera | 16MP Front Camera<br/>
            - 4000 mAh Battery<br/>
            - Qualcomm 712 Processor<br/>
            - FHD+ Super AMOLED Display<br/>
            - In Display Fingerprint Sensor<br/>
          </p>
          <br/>
          <h5>Description</h5>
          <p>The Realme XT smartphone is here to make your life more fun. From capturing amazing pictures with this phone’s 64 MP AI Quad camera to flaunting its hyperbola curved glass design, you will fall in love with this smartphone instantly. That’s not all, this smartphone comes with the Qualcomm Snapdragon 712 processor for efficient performance.</p>
        </div>
      </div>
    </div>

    <p class="webduplexnote">Quick Access Voice Keyboard Shortcut: Shift+S</p>

    <div class="action_credits">
      <button class="btnca btn btn-primary" onclick="showCredits()">Actions</button>
      <div class="sendleft center">
        <div class="credits">
          <div class="center" id="headline"><a href="http://dvcs.w3.org/hg/speech-api/raw-file/tip/speechapi.html">WebDuplex.js <br/>Web voice action plugin</a> demonstration</div>Google Chrome (Akash Patel [@patelakash317])
          <!-- instructions -->
            <br/>Start using this plugin for free <br/><b><a href="https://github.com/patelakash317/webduplex.js">Click here https://github.com/patelakash317/webduplex.js</a></b>
            <div class="text-left">
	            <br/><br/>
	            To test this plugin, press mic button at bottom right cornor of this page.
	            <br/><br/>
	            <b>After pressing mic button:</b><br/>
	            Test 1: Speak <b>"Information about this phone"</b><br/>
	            Test 2: Speak <b>"Internal storage capacity"</b><br/>
	            Test 3: Speak <b>"Processor used in this phone"</b><br/>
	            Test 4: Speak <b>"Brand of this smartphone"</b><br/>
	            Test 5: Speak <b>"Quality feature of this smartphone"</b><br/>
	            Test 6: Speak <b>"Battery capacity"</b><br/>
	          </div>

            <br/><br/>
            Likewise add any number of commands you want your users to get response of. 
            <br/><br/>
            Thank you for trying this plugin demonstration.<br/>
          <!-- instructions ends -->
        </div>
      </div>
    </p>
    <script type="text/javascript" src="./assets/js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="./assets/js/popper.min.js"></script>
    <script type="text/javascript" src="./assets/js/bootstrap.min.js"></script>

    <script>
      // additional function
        function showCredits(){
          // console.log(document.getElementsByClassName('showing'))
          if($('.action_credits').hasClass('showing')){
            // console.log('hiding');
            $('.action_credits').removeClass("showing");

            $('.btnca').html('Actions');
            $('.btnca').removeClass('btn-danger');
            $('.btnca').addClass('btn-primary');
          } else {
            // console.log('un-hiding');
            $('.action_credits').addClass("showing");
            
            $('.btnca').html('&nbsp; Hide&nbsp;');
            $('.btnca').addClass('btn-danger');
            $('.btnca').removeClass('btn-primary');
          }
        }
      // additional function ensd
    </script>

    <script type="text/javascript" src="./assets/webduplex/js/webduplex.min.js"></script>
    <!-- action functions -->
    <script>
      // request keywords
        // full
          // let action_block = {
          //   //speakAboutUs(),
          //   'visit,open,contact,contact us,Page': {
          //     action_type: 'redirect',
          //     action_value: 'http://localhost/webspeechdemo/contact.html',
          //   },
          //   'visit,redirect,about,inform,open,say,speak,tell,about us,page': {
          //     action_type: 'call_function',
          //     action_value: 'callout/about',
          //   },
          // };

        // specific
          action_block = {
            'tell,me,about,this,smartphone,phone,mobile,information,description': { // to speak about mobile description
              action_type: 'call_function',
              action_value: 'speakDescription',
              // action_value: 'callout/about',
            },
            'which,brand,name,more,this,smartphone': { // to speak about mobile brand 
              action_type: 'call_function',
              action_value: 'speakBrand',
              // action_value: 'callout/about',
            },
            'main,feature,quality,this,smartphone,best': { // to speak phone features
              action_type: 'call_function',
              action_value: 'speakFeatures',
              // action_value: 'callout/about',
            },
            'which,what,processor,used,smartphone': { // to speak about processor
              action_type: 'call_function',
              action_value: 'speakProccessor',
              // action_value: 'callout/about',
            },
            'tell,me,smartphone,and,internal,storage,capacity': { // to speak about main internal storage
              action_type: 'call_function',
              action_value: 'speakStorage',
              // action_value: 'callout/about',
            },
            'how,much,battery,life,this,smartphone': { // to speak about battery
              action_type: 'call_function',
              action_value: 'speakBattery',
              // action_value: 'callout/about',
            },
          };
      // request keywords ends

      function speakDescription(){
        recognition.stop();
        console.log('speak about description');
        var text = "The Realme XT smartphone is here to make your life more fun. From capturing amazing pictures with this phone’s 64 MP AI Quad camera to flaunting its hyperbola curved glass design, you will fall in love with this smartphone instantly. That's not all, this smartphone comes with the Qualcomm Snapdragon 712 processor for efficient performance.";
        speak(text);

        setTimeout(function(){
          console.log('recognition');
          if(!speaking){
            startRecognizingManually(); // to start recognising again manually
          }
        }, 5000);
      }

      function speakBrand(){
        recognition.stop();
        console.log('speak about brand');
        var text = "Sure, The brand name is Realme";
        speak(text);
        
        setTimeout(function(){
          console.log('recognition');
          if(!speaking){
            startRecognizingManually(); // to start recognising again manually
          }
        }, 5000);
      }

      function speakFeatures(){
        recognition.stop();
        // longer text fix: https://stackoverflow.com/questions/21947730/chrome-speech-synthesis-with-longer-texts -- update it later
        console.log('speak about brand');

        var largeData = "Let me see...!!.. It has 8GB of RAM with maximum of 128 GB of internal storage, along with expandable storage capacity upto 256 GB, having 4000 mAh battery life which can give you another half day to use it. It operates on latest Snapdragon processor, which is Qualcomm 712. The most interesting in this smartphone is it has indisplay Fingerprint scanner which is the latest technology used to built this smartphone, moreover, is gives you super experience with its FHD plus super AMOLED display, also unlike other smartphone Realme XT have Quad camera setup which enable you to capture even micro photos with its unique setup as below, it has 64 megapixel of main lens, 8 megapixel for depth sensing, 2 megapixel for wide-angle photos and 2 megapixel of micro-images shots, So, it is a Quad back camera setup. And it has 16MP in front camera. So this are the main features of Realme XT Smartphone.";
        speak(largeData);
      }

      // for long text
        // 1 - source: https://stackoverflow.com/a/48044163
          var myTimeout;
          function myTimer() {
            window.speechSynthesis.pause();
            window.speechSynthesis.resume();
            myTimeout = setTimeout(myTimer, 10000);
          }
      // for long text ends

      function speakProccessor(){
        recognition.stop();
        console.log('speak about processor');
        var text = "Let me see!!, Here you go!! it's Qualcomm 712 Processor";
        speak(text);
        
        setTimeout(function(){
          console.log('recognition');
          if(!speaking){
            startRecognizingManually(); // to start recognising again manually
          }
        }, 5000);
      }
      function speakStorage(){
        recognition.stop();
        console.log('speak about brand');
        var text = "It can store upto 128 GB of data of any type";
        speak(text);
        
        setTimeout(function(){
          console.log('recognition');
          if(!speaking){
            startRecognizingManually(); // to start recognising again manually
          }
        }, 5000);
      }
      function speakBattery(){
        recognition.stop();
        console.log('speak about brand');
        var text = "hmmm..... The battery provided with this smartphone has 4000 mAh capacity and can last long for one and a half day.";
        speak(text);
        
        setTimeout(function(){
          console.log('recognition');
          if(!speaking){
            startRecognizingManually(); // to start recognising again manually
          }
        }, 5000);
      }

      let speaking = false;
      function speak(text){
        // var text = $('#message').val();
        window.speechSynthesis.cancel();
        myTimeout = setTimeout(myTimer, 10000);

        var msg = new SpeechSynthesisUtterance();
        var voices = window.speechSynthesis.getVoices(); // find your prefered language from this list
        // console.log(voices); // uncomment this you will get the list in console, select one and pass it in below getLanguage function in second argument
        // let final_voices = getLanguage(voices, 'Google हिन्दी');
        let final_voices = getLanguage(voices, 'Google US English');
        if(final_voices == 'not'){
          console.log('No supporting language found.');
          alert(text);
        } else {
          speaking = true;
          // mentioned language supporting 
          msg.voice = final_voices;
          // voices[4]
          msg.rate = 10 / 10;
          msg.pitch = 1;
          // msg.voice = voices[$('#voices').val()];
          // msg.rate = $('#rate').val() / 10;
          // msg.pitch = $('#pitch').val();
          msg.text = text;

          msg.onend = function(e) {
            console.log('Finished in ' + event.elapsedTime + ' seconds.');
            speaking = false;
            clearTimeout(myTimeout);
          };
          speechSynthesis.speak(msg);
        }
      }
      function getLanguage(voices, language_name){
        let found = 'not';
        $.each(voices, function(index, value){
          if(found == 'not'){
            if(value.name.indexOf(language_name) !== -1){
              found = value;
            }
          }
        });
        return found;
      }
      $(function(){
        // speech source: https://codepen.io/SteveJRobertson/pen/emGWaR
        // support: https://developers.google.com/web/updates/2014/01/Web-apps-that-talk-Introduction-to-the-Speech-Synthesis-API
        if ('speechSynthesis' in window) {
          speechSynthesis.onvoiceschanged = function() {
            // var $voicelist = $('#voices');

            // if($voicelist.find('option').length == 0) {
              // speechSynthesis.getVoices().forEach(function(voice, index) {
              //   var $option = $('<option>')
              //   .val(index)
              //   .html(voice.name + (voice.default ? ' (default)' :''));

              //   $voicelist.append($option);
              // });
            // }
          };
          // speechSynthesis.onend = function() {
          //   // speechSynthesis.cancel(); 
          //   console.log('speach finished');
          // }
        } else {
        }
      });
    </script>
    <!-- action functions ends-->
  </body>
</html>